<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <link rel="icon" href="/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>豆瓣电影</title>
</head>

<body>
    <div id="app"></div>
    <script type="module" src="./src/main.js"></script>
</body>

</html>
<script>
    // 基础路径工具
    function getBasePath() {
        // GitHub Pages 通常部署到根路径
        if (window.location.hostname.includes('github.io')) {
            return '/'; // GitHub Pages 根路径
        }
        // 本地开发环境
        return '/';
    }

    const BASE_PATH = getBasePath();

    async function testCSV() {
        try {
            console.log('BASE_PATH:', BASE_PATH);
            console.log('当前URL:', window.location.href);
            
            const response = await fetch(`${BASE_PATH}data/movie_info.csv`);
            console.log('CSV response:', response.url, response.status);
            
            const csvText = await response.text();
            const lines = csvText.split('\n');
            document.getElementById('csv-output').innerHTML = `
          <p>CSV 文件读取成功</p>
          <p>总行数: ${lines.length}</p>
          <p>标题行: ${lines[0]}</p>
          <p>第二行: ${lines[1] || '无数据'}</p>
        `;
        } catch (error) {
            document.getElementById('csv-output').innerHTML = `<p>读取失败: ${error.message}</p>`;
            console.error('CSV读取错误:', error);
        }
    }

    // 立即测试CSV读取
    window.onload = testCSV;

    // 添加按钮
    document.addEventListener('DOMContentLoaded', function() {
        if (document.getElementById('app')) {
            const button = document.createElement('button');
            button.textContent = '重新测试CSV读取';
            button.onclick = testCSV;
            button.style.position = 'fixed';
            button.style.top = '10px';
            button.style.right = '10px';
            button.style.zIndex = '9999';
            button.style.padding = '10px';
            button.style.background = '#2196f3';
            button.style.color = 'white';
            button.style.border = 'none';
            button.style.borderRadius = '5px';
            document.body.appendChild(button);
        }

        // 添加结果显示区域
        const output = document.createElement('div');
        output.id = 'csv-output';
        output.style.position = 'fixed';
        output.style.bottom = '10px';
        output.style.right = '10px';
        output.style.background = 'white';
        output.style.padding = '15px';
        output.style.border = '1px solid #ccc';
        output.style.borderRadius = '5px';
        output.style.maxWidth = '400px';
        output.style.maxHeight = '200px';
        output.style.overflow = 'auto';
        output.style.zIndex = '9999';
        document.body.appendChild(output);
    });
</script>